# Combine Scaled Numeric Features and Dummy Variables
final_data <- cbind(combined_data %>% select(all_of(numeric_columns)), combined_data_dummies)
#Check for Multicollinearity
# Calculate the correlation matrix for the numeric features
cor_matrix <- cor(final_data)
#Check for Multicollinearity
# Select only numeric columns from final_data for correlation analysis
numeric_final_data <- final_data %>% select(where(is.numeric))
# Calculate the correlation matrix for the numeric features
cor_matrix <- cor(numeric_final_data, use = "pairwise.complete.obs")  # Handle NA values if present
# Optionally visualize the correlation matrix
library(ggcorrplot)
#Check for Multicollinearity
# Select only numeric columns from final_data for correlation analysis
numeric_final_data <- final_data %>% select(where(is.numeric))
# Calculate the correlation matrix for the numeric features
cor_matrix <- cor(numeric_final_data, use = "pairwise.complete.obs")  # Handle NA values if present
# Optionally visualize the correlation matrix
install.packages("ggcorrplot")
library(ggcorrplot)
ggcorrplot(cor_matrix, lab = TRUE)
knitr::opts_chunk$set(echo = TRUE)
install.packages("tidytuesdayR")
install.packages("ggcorrplot")
library(ggcorrplot)
library(dplyr)
library(tidyr)
library(ggplot2)
# Plot histograms
for (col in numeric_columns) {
ggplot(combined_data, aes_string(x = col)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.7) +
labs(title = paste("Distribution of", col), x = col, y = "Frequency") +
theme_minimal() +
print()  # Print the plot
}
install.packages("ggcorrplot")
install.packages("tidytuesdayR")
# Plot histograms
for (col in numeric_columns) {
ggplot(combined_data, aes_string(x = col)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.7) +
labs(title = paste("Distribution of", col), x = col, y = "Frequency") +
theme_minimal() +
print()  # Print the plot
}
# Plot histograms
for (col in numeric_columns) {
p <- ggplot(combined_data, aes_string(x = col)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.7) +
labs(title = paste("Distribution of", col), x = col, y = "Frequency") +
theme_minimal()
print(p)  # Print the plot
}
### 2. Boxplots to Identify Outliers
# Create boxplots for numeric variables
for (col in numeric_columns) {
p <- ggplot(combined_data, aes_string(x = "factor(0)", y = col)) +
geom_boxplot(fill = "lightblue") +
labs(title = paste("Boxplot of", col), x = "", y = col) +
theme_minimal()
print(p)  # Print the plot
}
### 3. Count of Age Groups
# Bar plot for Age Group distribution
p_age_group <- ggplot(combined_data, aes(x = AgeGroup)) +
geom_bar(fill = "coral") +
labs(title = "Count of Age Groups", x = "Age Group", y = "Count") +
theme_minimal()
print(p_age_group)
### 4. Gender Distribution
# Bar plot for Gender distribution
p_gender <- ggplot(combined_data, aes(x = Gender)) +
geom_bar(fill = "lightgreen") +
labs(title = "Gender Distribution", x = "Gender", y = "Count") +
theme_minimal()
print(p_gender)
### 5. Pairwise Scatter Plots
# Create a pairs plot for numeric variables
pairs_plot <- pairs(combined_data[numeric_columns],
main = "Pairwise Scatter Plots",
pch = 19,
col = rgb(0, 0, 1, alpha = 0.5))
### 6. Correlation Heatmap
# Calculate the correlation matrix
cor_matrix <- cor(combined_data[numeric_columns], use = "pairwise.complete.obs")
ggcorrplot(cor_matrix, lab = TRUE, title = "Correlation Heatmap")
ggplot(valentines_data, aes(x = gender, y = spending)) +
geom_boxplot(fill = "pink") +
labs(title = "Spending Distribution by Gender", x = "Gender", y = "Spending Amount")
# Plot histograms
for (col in numeric_columns) {
p <- ggplot(final_data, aes_string(x = col)) +
geom_histogram(bins = 30, fill = "blue", color = "black", alpha = 0.7) +
labs(title = paste("Distribution of", col), x = col, y = "Frequency") +
theme_minimal()
print(p)  # Print the plot
}
### 2. Boxplots to Identify Outliers
# Create boxplots for numeric variables
for (col in numeric_columns) {
p <- ggplot(combined_data, aes_string(x = "factor(0)", y = col)) +
geom_boxplot(fill = "lightblue") +
labs(title = paste("Boxplot of", col), x = "", y = col) +
theme_minimal()
print(p)  # Print the plot
}
### 3. Count of Age Groups
# Bar plot for Age Group distribution
p_age_group <- ggplot(combined_data, aes(x = AgeGroup)) +
geom_bar(fill = "coral") +
labs(title = "Count of Age Groups", x = "Age Group", y = "Count") +
theme_minimal()
print(p_age_group)
### 4. Gender Distribution
# Bar plot for Gender distribution
p_gender <- ggplot(combined_data, aes(x = Gender)) +
geom_bar(fill = "lightgreen") +
labs(title = "Gender Distribution", x = "Gender", y = "Count") +
theme_minimal()
print(p_gender)
### 5. Pairwise Scatter Plots
# Create a pairs plot for numeric variables
pairs_plot <- pairs(combined_data[numeric_columns],
main = "Pairwise Scatter Plots",
pch = 19,
col = rgb(0, 0, 1, alpha = 0.5))
### 6. Correlation Heatmap
# Calculate the correlation matrix
cor_matrix <- cor(combined_data[numeric_columns], use = "pairwise.complete.obs")
ggcorrplot(cor_matrix, lab = TRUE, title = "Correlation Heatmap")
ggplot(final_data, aes(x = gender, y = spending)) +
geom_boxplot(fill = "pink") +
labs(title = "Spending Distribution by Gender", x = "Gender", y = "Spending Amount")
ggplot(final_data, aes(x = Gender, y = PerPerson)) +
geom_boxplot(fill = "pink") +
labs(title = "Per Person Spending by Gender", x = "Gender", y = "Spending Per Person")
ggplot(final_data, aes(x = spending)) +
geom_histogram(bins = 30, fill = "lightblue", color = "black") +
labs(title = "Distribution of Spending Amounts", x = "Spending Amount", y = "Frequency")
ggplot(final_data, aes(x = Gender, y = PerPerson)) +
geom_boxplot(fill = "pink") +
labs(title = "Per Person Spending by Gender", x = "Gender", y = "Spending Per Person")
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(bins = 30, fill = "lightblue", color = "black") +
labs(title = "Distribution of Spending Amounts", x = "Spending Amount", y = "Frequency")
ggplot(final_data, aes(x = PerPerson)) +
geom_density(fill = "red", alpha = 0.5) +
labs(title = "Density of Spending Amounts", x = "Spending Amount", y = "Density")
cor_matrix <- cor(select(final_data, PerPerson, satisfaction, number_of_gifts), use = "complete.obs")
ggplot(final_data, aes(x = Gender, y = PerPerson)) +
geom_boxplot(fill = "pink") +
labs(title = "Per Person Spending by Gender", x = "Gender", y = "Spending Per Person")
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(bins = 30, fill = "lightblue", color = "black") +
labs(title = "Distribution of Spending Amounts", x = "Spending Amount", y = "Frequency")
ggplot(final_data, aes(x = PerPerson)) +
geom_density(fill = "red", alpha = 0.5) +
labs(title = "Density of Spending Amounts", x = "Spending Amount", y = "Density")
#cor_matrix <- cor(select(final_data, PerPerson, satisfaction, number_of_gifts), use = "complete.obs")
#ggcorrplot(cor_matrix, lab = TRUE)
ggplot(final_data, aes(x = PerPerson, fill = gift_type)) +
geom_histogram(position = "dodge") +
facet_wrap(~ age_group) +
labs(title = "Spending by Gift Type and Age Group", x = "Spending Amount", y = "Frequency")
View(final_data)
ggplot(final_data, aes(x = Gender, y = PerPerson)) +
geom_boxplot(fill = "pink") +
labs(title = "Per Person Spending by Gender", x = "Gender", y = "Spending Per Person")
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(bins = 30, fill = "lightblue", color = "black") +
labs(title = "Distribution of Spending Amounts", x = "Spending Amount", y = "Frequency")
ggplot(final_data, aes(x = PerPerson)) +
geom_density(fill = "red", alpha = 0.5) +
labs(title = "Density of Spending Amounts", x = "Spending Amount", y = "Density")
#cor_matrix <- cor(select(final_data, PerPerson, satisfaction, number_of_gifts), use = "complete.obs")
#ggcorrplot(cor_matrix, lab = TRUE)
ggplot(final_data, aes(x = PerPerson, fill = gift_type)) +
geom_histogram(position = "dodge") +
facet_wrap(~ Age) +
labs(title = "Spending by Gift Type and Age Group", x = "Spending Amount", y = "Frequency")
ggplot(final_data, aes(x = Gender, y = PerPerson)) +
geom_boxplot(fill = "pink") +
labs(title = "Per Person Spending by Gender", x = "Gender", y = "Spending Per Person")
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(bins = 30, fill = "lightblue", color = "black") +
labs(title = "Distribution of Spending Amounts", x = "Spending Amount", y = "Frequency")
ggplot(final_data, aes(x = PerPerson)) +
geom_density(fill = "red", alpha = 0.5) +
labs(title = "Density of Spending Amounts", x = "Spending Amount", y = "Density")
#cor_matrix <- cor(select(final_data, PerPerson, satisfaction, number_of_gifts), use = "complete.obs")
#ggcorrplot(cor_matrix, lab = TRUE)
#ggplot(final_data, aes(x = PerPerson, fill = gift_type)) +
#   geom_histogram(position = "dodge") +
#   facet_wrap(~ Age) +
#   labs(title = "Spending by Gift Type and Age Group", x = "Spending Amount", y = #"Frequency")
ggplot(final_data, aes(x = PerPerson, y = satisfaction)) +
geom_point(alpha = 0.5, color = "purple") +
labs(title = "Spending vs. Satisfaction", x = "Spending Amount", y = "Satisfaction Rating")
ggplot(final_data, aes(x = Gender, y = PerPerson)) +
geom_boxplot(fill = "pink") +
labs(title = "Per Person Spending by Gender", x = "Gender", y = "Spending Per Person")
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(bins = 30, fill = "lightblue", color = "black") +
labs(title = "Distribution of Spending Amounts", x = "Spending Amount", y = "Frequency")
ggplot(final_data, aes(x = PerPerson)) +
geom_density(fill = "red", alpha = 0.5) +
labs(title = "Density of Spending Amounts", x = "Spending Amount", y = "Density")
#cor_matrix <- cor(select(final_data, PerPerson, satisfaction, number_of_gifts), use = "complete.obs")
#ggcorrplot(cor_matrix, lab = TRUE)
#ggplot(final_data, aes(x = PerPerson, fill = gift_type)) +
#   geom_histogram(position = "dodge") +
#   facet_wrap(~ Age) +
#   labs(title = "Spending by Gift Type and Age Group", x = "Spending Amount", y = #"Frequency")
ggplot(final_data, aes(x = year, y = PerPerson)) +
geom_line() +
labs(title = "Trends in Spending Over Time", x = "Year", y = "Spending Amount")
ggplot(final_data, aes(x = Gender, y = PerPerson)) +
geom_boxplot(fill = "pink") +
labs(title = "Per Person Spending by Gender", x = "Gender", y = "Spending Per Person")
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(bins = 30, fill = "lightblue", color = "black") +
labs(title = "Distribution of Spending Amounts", x = "Spending Amount", y = "Frequency")
ggplot(final_data, aes(x = PerPerson)) +
geom_density(fill = "red", alpha = 0.5) +
labs(title = "Density of Spending Amounts", x = "Spending Amount", y = "Density")
#cor_matrix <- cor(select(final_data, PerPerson, satisfaction, number_of_gifts), use = "complete.obs")
#ggcorrplot(cor_matrix, lab = TRUE)
#ggplot(final_data, aes(x = PerPerson, fill = gift_type)) +
#   geom_histogram(position = "dodge") +
#   facet_wrap(~ Age) +
#   labs(title = "Spending by Gift Type and Age Group", x = "Spending Amount", y = #"Frequency")
ggplot(final_data, aes(x = Year, y = PerPerson)) +
geom_line() +
labs(title = "Trends in Spending Over Time", x = "Year", y = "Spending Amount")
write.csv(final_data, "/Users/avaexelbirt/Downloads/final_data.csv", row.names = FALSE)
ggplot(final_data, aes(x = Gender, y = PerPerson)) +
geom_boxplot(fill = "pink") +
labs(title = "Per Person Spending by Gender", x = "Gender", y = "Spending Per Person")
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(bins = 30, fill = "lightblue", color = "black") +
labs(title = "Distribution of Spending Amounts", x = "Spending Amount", y = "Frequency")
ggplot(final_data, aes(x = PerPerson)) +
geom_density(fill = "red", alpha = 0.5) +
labs(title = "Density of Spending Amounts", x = "Spending Amount", y = "Density")
ggplot(final_data, aes(x = Year, y = PerPerson)) +
geom_line() +
labs(title = "Trends in Spending Over Time", x = "Year", y = "Spending Amount")
# Visualize distribution of spending per person
ggplot(data, aes(x = PerPerson)) +
geom_histogram(binwidth = 10, fill = "pink", color = "black") +
labs(title = "Distribution of Spending per Person",
x = "Spending per Person ($)",
y = "Frequency") +
theme_minimal()
ggplot(final_data, aes(x = Gender, y = PerPerson)) +
geom_boxplot(fill = "pink") +
labs(title = "Per Person Spending by Gender", x = "Gender", y = "Spending Per Person")
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(bins = 30, fill = "lightblue", color = "black") +
labs(title = "Distribution of Spending Amounts", x = "Spending Amount", y = "Frequency")
ggplot(final_data, aes(x = PerPerson)) +
geom_density(fill = "red", alpha = 0.5) +
labs(title = "Density of Spending Amounts", x = "Spending Amount", y = "Density")
ggplot(final_data, aes(x = Year, y = PerPerson)) +
geom_line() +
labs(title = "Trends in Spending Over Time", x = "Year", y = "Spending Amount")
# Visualize distribution of spending per person
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(binwidth = 10, fill = "pink", color = "black") +
labs(title = "Distribution of Spending per Person",
x = "Spending per Person ($)",
y = "Frequency") +
theme_minimal()
# Boxplot of spending per person by gender
ggplot(final_data, aes(x = Gender, y = PerPerson, fill = Gender)) +
geom_boxplot() +
labs(title = "Spending per Person by Gender",
x = "Gender",
y = "Spending per Person ($)") +
theme_minimal()
# Bar plot for average spending on gifts by gender
avg_spending_gender <- data %>%
group_by(Gender) %>%
summarise(across(starts_with("gender_"), mean, na.rm = TRUE))
ggplot(final_data, aes(x = Gender, y = PerPerson)) +
geom_boxplot(fill = "pink") +
labs(title = "Per Person Spending by Gender", x = "Gender", y = "Spending Per Person")
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(bins = 30, fill = "lightblue", color = "black") +
labs(title = "Distribution of Spending Amounts", x = "Spending Amount", y = "Frequency")
ggplot(final_data, aes(x = PerPerson)) +
geom_density(fill = "red", alpha = 0.5) +
labs(title = "Density of Spending Amounts", x = "Spending Amount", y = "Density")
ggplot(final_data, aes(x = Year, y = PerPerson)) +
geom_line() +
labs(title = "Trends in Spending Over Time", x = "Year", y = "Spending Amount")
# Visualize distribution of spending per person
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(binwidth = 10, fill = "pink", color = "black") +
labs(title = "Distribution of Spending per Person",
x = "Spending per Person ($)",
y = "Frequency") +
theme_minimal()
# Bar plot for average spending on gifts by gender
avg_spending_gender <- data %>%
group_by(Gender) %>%
summarise(across(starts_with("gender_"), mean, na.rm = TRUE), .groups = 'drop')
ggplot(final_data, aes(x = Gender, y = PerPerson)) +
geom_boxplot(fill = "pink") +
labs(title = "Per Person Spending by Gender", x = "Gender", y = "Spending Per Person")
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(bins = 30, fill = "lightblue", color = "black") +
labs(title = "Distribution of Spending Amounts", x = "Spending Amount", y = "Frequency")
ggplot(final_data, aes(x = PerPerson)) +
geom_density(fill = "red", alpha = 0.5) +
labs(title = "Density of Spending Amounts", x = "Spending Amount", y = "Density")
ggplot(final_data, aes(x = Year, y = PerPerson)) +
geom_line() +
labs(title = "Trends in Spending Over Time", x = "Year", y = "Spending Amount")
# Visualize distribution of spending per person
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(binwidth = 10, fill = "pink", color = "black") +
labs(title = "Distribution of Spending per Person",
x = "Spending per Person ($)",
y = "Frequency") +
theme_minimal()
# Reshape the data for plotting
avg_spending_gender_long <- avg_spending_gender %>%
pivot_longer(cols = -Gender, names_to = "Gift_Type", values_to = "Average_Spending")
ggplot(final_data, aes(x = Gender, y = PerPerson)) +
geom_boxplot(fill = "pink") +
labs(title = "Per Person Spending by Gender", x = "Gender", y = "Spending Per Person")
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(bins = 30, fill = "lightblue", color = "black") +
labs(title = "Distribution of Spending Amounts", x = "Spending Amount", y = "Frequency")
ggplot(final_data, aes(x = PerPerson)) +
geom_density(fill = "red", alpha = 0.5) +
labs(title = "Density of Spending Amounts", x = "Spending Amount", y = "Density")
ggplot(final_data, aes(x = Year, y = PerPerson)) +
geom_line() +
labs(title = "Trends in Spending Over Time", x = "Year", y = "Spending Amount")
# Visualize distribution of spending per person
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(binwidth = 10, fill = "pink", color = "black") +
labs(title = "Distribution of Spending per Person",
x = "Spending per Person ($)",
y = "Frequency") +
theme_minimal()
# Boxplot of spending per person by gender
ggplot(final_data, aes(x = Gender, y = PerPerson, fill = Gender)) +
geom_boxplot() +
labs(title = "Spending per Person by Gender",
x = "Gender",
y = "Spending per Person ($)") +
theme_minimal()
# Bar plot for average spending on gifts by gender
avg_spending_gender <- data %>%
group_by(Gender) %>%
summarise(across(starts_with("gender_"), mean, na.rm = TRUE))
# Bar plot for average spending on gifts by gender
avg_spending_gender <- final_data %>%
group_by(Gender) %>%
summarise(across(starts_with("gender_"), mean, na.rm = TRUE), .groups = 'drop')
# Reshape the data for plotting
avg_spending_gender_long <- avg_spending_gender %>%
pivot_longer(cols = -Gender, names_to = "Gift_Type", values_to = "Average_Spending")
ggplot(final_data, aes(x = Gender, y = PerPerson)) +
geom_boxplot(fill = "pink") +
labs(title = "Per Person Spending by Gender", x = "Gender", y = "Spending Per Person")
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(bins = 30, fill = "lightblue", color = "black") +
labs(title = "Distribution of Spending Amounts", x = "Spending Amount", y = "Frequency")
ggplot(final_data, aes(x = PerPerson)) +
geom_density(fill = "red", alpha = 0.5) +
labs(title = "Density of Spending Amounts", x = "Spending Amount", y = "Density")
ggplot(final_data, aes(x = Year, y = PerPerson)) +
geom_line() +
labs(title = "Trends in Spending Over Time", x = "Year", y = "Spending Amount")
# Visualize distribution of spending per person
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(binwidth = 10, fill = "pink", color = "black") +
labs(title = "Distribution of Spending per Person",
x = "Spending per Person ($)",
y = "Frequency") +
theme_minimal()
# Boxplot of spending per person by gender
ggplot(final_data, aes(x = Gender, y = PerPerson, fill = Gender)) +
geom_boxplot() +
labs(title = "Spending per Person by Gender",
x = "Gender",
y = "Spending per Person ($)") +
theme_minimal()
# Bar plot for average spending on gifts by gender
avg_spending_gender <- final_data %>%
group_by(Gender) %>%
summarise(across(starts_with("gender_"), mean, na.rm = TRUE), .groups = 'drop')
# Reshape the data for plotting
avg_spending_gender_long <- avg_spending_gender %>%
pivot_longer(cols = -Gender, names_to = "Gift_Type", values_to = "Average_Spending")
# Create the bar plot
ggplot(avg_spending_gender_long, aes(x = Gift_Type, y = Average_Spending, fill = Gender)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Average Spending on Gifts by Gender",
x = "Gift Type",
y = "Average Spending ($)") +
theme_minimal() +
coord_flip()
# Bar plot for average spending on gifts by gender
avg_spending_gender <- data %>%
group_by(Gender) %>%
summarise(across(starts_with("gender_"), mean, na.rm = TRUE))
ggplot(final_data, aes(x = Gender, y = PerPerson)) +
geom_boxplot(fill = "pink") +
labs(title = "Per Person Spending by Gender", x = "Gender", y = "Spending Per Person")
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(bins = 30, fill = "lightblue", color = "black") +
labs(title = "Distribution of Spending Amounts", x = "Spending Amount", y = "Frequency")
ggplot(final_data, aes(x = PerPerson)) +
geom_density(fill = "red", alpha = 0.5) +
labs(title = "Density of Spending Amounts", x = "Spending Amount", y = "Density")
ggplot(final_data, aes(x = Year, y = PerPerson)) +
geom_line() +
labs(title = "Trends in Spending Over Time", x = "Year", y = "Spending Amount")
# Visualize distribution of spending per person
ggplot(final_data, aes(x = PerPerson)) +
geom_histogram(binwidth = 10, fill = "pink", color = "black") +
labs(title = "Distribution of Spending per Person",
x = "Spending per Person ($)",
y = "Frequency") +
theme_minimal()
# Boxplot of spending per person by gender
ggplot(final_data, aes(x = Gender, y = PerPerson, fill = Gender)) +
geom_boxplot() +
labs(title = "Spending per Person by Gender",
x = "Gender",
y = "Spending per Person ($)") +
theme_minimal()
# Bar plot for average spending on gifts by gender
avg_spending_gender <- final_data %>%
group_by(Gender) %>%
summarise(across(starts_with("gender_"), mean, na.rm = TRUE), .groups = 'drop')
# Reshape the data for plotting
avg_spending_gender_long <- avg_spending_gender %>%
pivot_longer(cols = -Gender, names_to = "Gift_Type", values_to = "Average_Spending")
# Create the bar plot
ggplot(avg_spending_gender_long, aes(x = Gift_Type, y = Average_Spending, fill = Gender)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Average Spending on Gifts by Gender",
x = "Gift Type",
y = "Average Spending ($)") +
theme_minimal() +
coord_flip()
# Bar plot for average spending on gifts by gender
avg_spending_gender <- final_data %>%
group_by(Gender) %>%
summarise(across(starts_with("gender_"), mean, na.rm = TRUE))
avg_spending_gender_long <- avg_spending_gender %>%
pivot_longer(cols = -Gender, names_to = "Gift_Type", values_to = "Average_Spending")
ggplot(avg_spending_gender_long, aes(x = Gift_Type, y = Average_Spending, fill = Gender)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Average Spending on Gifts by Gender",
x = "Gift Type",
y = "Average Spending ($)") +
theme_minimal() +
coord_flip()
# Correlation heatmap for numerical variables
correlation_matrix <- cor(final_data %>% select(PerPerson, Candy, Flowers, Jewelry,
GreetingCards, EveningOut, Clothing,
GiftCards, age_SpendingCelebrating,
gender_SpendingCelebrating, TotalGiftSpending), use = "complete.obs")
ggcorrplot(correlation_matrix, lab = TRUE, title = "Correlation Heatmap")
# Age group spending analysis
ggplot(final_data, aes(x = AgeGroup, y = PerPerson, fill = AgeGroup)) +
geom_boxplot() +
labs(title = "Spending per Person by Age Group",
x = "Age Group",
y = "Spending per Person ($)") +
theme_minimal()
# Visualize spending on specific gifts by age group
ggplot(final_data) +
geom_bar(aes(x = AgeGroup, y = Candy, fill = "Candy"), stat = "identity", position = "dodge") +
geom_bar(aes(x = AgeGroup, y = Flowers, fill = "Flowers"), stat = "identity", position = "dodge") +
labs(title = "Spending on Gifts by Age Group",
x = "Age Group",
y = "Spending Amount ($)") +
theme_minimal() +
scale_fill_manual(values = c("Candy" = "red", "Flowers" = "blue")) +
theme(legend.title = element_blank())
# Bar plot for average spending on gifts by gender
avg_spending_gender <- final_data %>%
group_by(Gender) %>%
summarise(across(starts_with("gender_"), mean, na.rm = TRUE), .groups = 'drop')
# Reshape the data for plotting
avg_spending_gender_long <- avg_spending_gender %>%
pivot_longer(cols = -Gender, names_to = "Gift_Type", values_to = "Average_Spending")
# Create the bar plot
ggplot(avg_spending_gender_long, aes(x = Gift_Type, y = Average_Spending, fill = Gender)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Average Spending on Gifts by Gender",
x = "Gift Type",
y = "Average Spending ($)") +
theme_minimal() +
coord_flip()
knitr::opts_chunk$set(echo = TRUE)
install.packages("tidytuesdayR")
install.packages("ggcorrplot")
library(ggcorrplot)
library(dplyr)
library(tidyr)
library(ggplot2)
tuesdata <- tidytuesdayR::tt_load('2024-02-13')
